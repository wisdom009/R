theme(axis.text.x = element_text(angle = 45, hjust = 1,vjust = 1,colour = "black",size = 10))
economics
ggplot(economics, aes(x=date, y=psavert))+
geom_line()
# --6--
mpg
mpg2 = mpg %>%
group_by(class) %>%
select(cty,class) %>%
filter(class %in% c('compact','subcompact','suv'))
mpg2
ggplot(economics, aes(x=date, y=psavert))+
geom_line()
ggplot(mpg, aes(x=cty, y=hwy)) + geom_point()
ggplot(mpg, aes(x=cty, y=hwy)) + geom_point()
#-4-
mpg1=mpg %>%
group_by(model) %>%
select(model,class) %>%
filter(class %in% c('suv')) %>%
summarise_each(funs(n())) %>%
arrange(desc(class))
mpg1
ggplot(mpg1,aes(x=model, y=class)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1,vjust = 1,colour = "black",size = 10))
ggplot(mpg1,aes(x=model, y=class)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1,vjust = 1,colour = "black",size = 10)) +
limit(5)
mpg3=mpg %>%
group_by(manufacturer) %>%
select(manufacturer, class, cty) %>%
filter(class %in% c('suv')) %>%
summarise_each(funs(n())) %>%
arrange(desc(mean_cty)) %>%
head(5)
mpg3=mpg %>%
group_by(manufacturer) %>%
select(manufacturer, class, cty) %>%
filter(class %in% c('suv')) %>%
summarise(mean_cty =mean(cty)) %>%
arrange(desc(mean_cty)) %>%
head(5)
mpg3=mpg %>%
group_by(manufacturer) %>%
select(manufacturer, class, cty) %>%
filter(class %in% c('suv')) %>%
summarise(mean_cty =mean(cty)) %>%
arrange(desc(mean_cty)) %>%
head(5)
mpg3
ggplot(mpg3, aes(x=manufacturer, y=cty)) + geom_bar()
ggplot(mpg1,aes(x=model, y=class)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1,vjust = 1,colour = "black",size = 10)) +
#---5--
economics
ggplot(economics, aes(x=date, y=psavert))+
geom_line()
# --6--
mpg
mpg2 = mpg %>%
group_by(class) %>%
select(cty,class) %>%
filter(class %in% c('compact','subcompact','suv'))
mpg2
ggplot(mpg2, aes(x = class, y = cty)) + geom_boxplot(fill=c("blue","green","red"))
mpg2 = mpg %>%
group_by(class) %>%
select(cty,class) %>%
filter(class %in% c('compact','subcompact','suv'))
mpg2
ggplot(economics, aes(x=date, y=psavert))+
geom_line()
# --6--
mpg
mpg2 = mpg %>%
group_by(class) %>%
select(cty,class) %>%
filter(class %in% c('compact','subcompact','suv'))
mpg2
ggplot(mpg2, aes(x = class, y = cty)) + geom_boxplot(fill=c("blue","green","red"))
ggplot(diamonds, aes(x=cut, fill=cut)) +
geom.bar()
ggplot(diamonds, aes(x=cut, fill=cut)) +
geom.bar()
ggplot(diamonds, aes(x=cut, fill=cut)) +
geom_bar()
#--7-2-
ggplot(diamonds, aes(x=cut, y=price)) +
geom_bar(stat = "identity",fill="blue") +
theme(axis.text.x = element_text(angle = 45, hjust = 1,vjust = 1,colour = "black",size = 10),
axis.text.y = element_text(angle = 30, hjust = 1,vjust = 1,size = 10))
dd= diamonds %>%
group_by(cut) %>%
summarise(mean_price = mean(price))
ggplot(dd, aes(x=cut, y=mean_price, fill=cut)) +
geom_col()
ggplot(diamonds, aes(x=price)) +
goem_histogram(bins=10) +
facet_wrap(cut)
knitr::opts_chunk$set(echo = TRUE)
```{r}
knitr::opts_chunk$set(echo = TRUE)
```{r}
knitr::opts_chunk$set(echo = TRUE)
```{r mpg}
knitr::opts_chunk$set(echo = TRUE)
```{r mpg}
```{r mpg}
library(dplyr)
library(dplyr)
library(ggplot2)
library(dplyr)
library(dplyr)
library(ggplot2)
knitr::opts_chunk$set(echo = TRUE)
```{r mpg}
library(dplyr)
library(ggplot2)
library(dplyr)
library(ggplot2)
library(dplyr)
library(ggplot2)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
```{r mpg}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
ggplot(mpg, aes(x=cty, y=hwy))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
ggplot(mpg, aes(x=cty, y=hwy)) +
geom_point(size=2, color='red') +
ggtitle('mpg 데이터 cty(도시연비)와 hwy(고속도로연비) 산점도')
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
ggplot(mpg, aes(x=cty, y=hwy)) +
ggtitle('mpg 데이터 cty(도시연비)와 hwy(고속도로연비) 산점도')
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
ggplot(mpg, aes(x=cty, y=hwy)) +
geom_point(size=3, color='blue') +
ggtitle('cty와hwy산점도')
View(d3)
View(three)
View(ss)
View(score_e)
View(score_e)
View(score)
View(mpg3)
View(mpg1)
View(mpg_a)
View(mp)
barplot(data, aes(버스노선번호, aa ))+
geom_bar(stat='identity', position = 'dodge')
geom_text(aes(y=사용자, label=사용자),
color="black", size=3)
View(mpg3)
View(dd)
View(d3)
View(dis)
View(mpg2)
View(score)
View(three)
View(mpg3)
View(ss)
View(d3)
data2= gsub("고흐","",data2)
data2= gsub("나","",data2)
data2= gsub("내","",data2)
data2= gsub("것","",data2)
data2= gsub("너","",data2)
data2= gsub("[a-y]","",data2)
data2= gsub("지","",data2)
data2= gsub("한","",data2)
write(unlist(data2),"pop.txt")
data3 = read.table("pop.txt", quote="")
data3
wordcount=table(data3)
nrow(data3)
library(ggplot2)
library(dplyr)
library(reshape2)
library(extrafont)
windowsFonts(malgun = "맑은 고딕")
theme_update(text = element_text(family = "malgun"))
unemployment <- read.csv('2000-2013년 연령별실업율_연령별평균_세로.csv')
unemployment
unemployment_melt <- melt(unemployment, id=c('연도'),
variable.name='연령', value.name='실업률')
unemployment_melt$연령 <- gsub("X", "", unemployment_melt$연령)
ggplot(unemployment_melt, aes(x=연도, y=실업률, fill=연령,
color=연령, group=연령)) +
geom_line(linetype=1, size=1) +
geom_point(shape=19, size=3) +
geom_hline(yintercept=seq(0,10,0.5), lty='dashed', size=0.1) +
theme_bw(base_family='malgun',base_size = 10) +
#theme(axis.title.x = element_blank()) +
#theme(axis.title.y = element_blank()) +
theme(axis.text.x  = element_text(angle=45, hjust=1)) +
labs(x = '년도', y = '실업률') +
ggtitle('연령대별 실업률 현황(단위:%) 출처:통계청') +
theme(plot.title = element_text(family="malgun", face = "bold", hjust = 0.5,
vjust = 2.5, size = 15, color = "darkblue"))
setwd("D:/workspace/R_date/Part2/새 폴더")
library(KoNLP)
library(KoNLP)
library(wordcloud)
library(RColorBrewer)
library(KoNLP)
library(wordcloud)
library(RColorBrewer)
useSejongDic()
data1= readLines("응답소_2015_01.txt")
data2 = sapply(data1, extractNoun, USE.NAMES = F)
data3 = unlist(data2)
data3= Filter(function(x) {nchar(x) >= 2}, data3)
head(unlist(data3),30)
data3 = str_replace_all(cdata, "[^[:alpha:]]", "")
data1= readLines("응답소_2015_01.txt")
data2 = sapply(data1, extractNoun, USE.NAMES = F)
data3 = unlist(data2)
data3= Filter(function(x) {nchar(x) >= 2}, data3)
head(unlist(data3),30)
data3 = gsub("\\='","",data3)
data3 = gsub("\\'","",data3)
data3 = gsub("\\.","",data3)
data3 = gsub("\\d+","",data3)
data3 = gsub("[ㄱ-ㅎ]","",data3)
data3 = gsub("(ㅜ|ㅠ)","",data3)
data3 = gsub("[0-9]","",data3)
data3 = gsub("[a-z]","",data3)
data3 = gsub("[A-Z]","",data3)
data3 = gsub(" ","",data3)
data3 = gsub("Q","",data3)
data3 = gsub("","",data3)
data3 = gsub("제목","",data3)
data3 = gsub("아니고","",data3)
data3 = gsub("서울시","",data3)
data3 = gsub("서울","",data3)
data3 = gsub("상담내용","",data3)
data3 = gsub("--상담내용","",data3)
data3 = gsub("\\-","",data3)
write(unlist(data3), "응답소gsub_01.txt")
data4=read.table("응답소gsub_01.txt")
nrow(data4)
wordcount = table(data4)
wordcount
palete = brewer.pal(10, "Set1")
head(sort(wordcount, decreasing=T),20)
wordcloud(names(wordcount),freq=wordcount,scale=c(1,0.5),rot.per=0.25,min.freq=35,
random.order=F,random.color=T,colors=palete)
data1= readLines("응답소_2015_01.txt")
data2 = sapply(data1, extractNoun, USE.NAMES = F)
data3 = unlist(data2)
data3= Filter(function(x) {nchar(x) >= 2}, data3)
head(unlist(data3),30)
data3 = gsub("\\='","",data3)
data3 = gsub("\\'","",data3)
data3 = gsub("\\.","",data3)
data3 = gsub("\\d+","",data3)
data3 = gsub("[ㄱ-ㅎ]","",data3)
data3 = gsub("(ㅜ|ㅠ)","",data3)
data3 = gsub("[0-9]","",data3)
data3 = gsub("[a-z]","",data3)
data3 = gsub("[A-Z]","",data3)
data3 = gsub(" ","",data3)
data3 = gsub("Q","",data3)
data3 = gsub("","",data3)
data3 = gsub("제목","",data3)
data3 = gsub("아니고","",data3)
data3 = gsub("서울시","",data3)
data3 = gsub("서울","",data3)
data3 = gsub("상담내용","",data3)
data3 = gsub("--상담내용","",data3)
data3 = gsub("\\-","",data3)
write(unlist(data3), "응답소gsub_01.txt")
data4=read.table("응답소gsub_01.txt")
nrow(data4)
wordcount = table(data4)
palete = brewer.pal(10, "Set1")
head(sort(wordcount, decreasing=T),20)
wordcloud(names(wordcount),freq=wordcount,scale=c(1,0.5),rot.per=0.25,min.freq=35,
random.order=F,random.color=T,colors=palete)
#2
data1= readLines("응답소_2015_02.txt")
data2 = sapply(data1, extractNoun, USE.NAMES = F)
data3 = unlist(data2)
data3= Filter(function(x) {nchar(x) >= 2}, data3)
head(unlist(data3),30)
data3 = gsub("\\='","",data3)
data3 = gsub("\\'","",data3)
data3 = gsub("\\.","",data3)
data3 = gsub("\\d+","",data3)
data3 = gsub("[ㄱ-ㅎ]","",data3)
data3 = gsub("(ㅜ|ㅠ)","",data3)
data3 = gsub("[0-9]","",data3)
data3 = gsub("[a-z]","",data3)
data3 = gsub("[A-Z]","",data3)
data3 = gsub(" ","",data3)
data3 = gsub("Q","",data3)
data3 = gsub("","",data3)
data3 = gsub("제목","",data3)
data3 = gsub("아니고","",data3)
data3 = gsub("서울시","",data3)
data3 = gsub("서울","",data3)
data3 = gsub("상담내용","",data3)
data3 = gsub("--상담내용","",data3)
data3 = gsub("\\-","",data3)
write(unlist(data3), "응답소gsub_02.txt")
data4=read.table("응답소gsub_02.txt")
nrow(data4)
wordcount = table(data4)
palete = brewer.pal(10, "Set1")
head(sort(wordcount, decreasing=T),20)
wordcloud(names(wordcount),freq=wordcount,scale=c(1,0.5),rot.per=0.25,min.freq=10,
random.order=F,random.color=T,colors=palete)
# 3
data1= readLines("응답소_2015_03.txt")
data2 = sapply(data1, extractNoun, USE.NAMES = F)
data3 = unlist(data2)
data3= Filter(function(x) {nchar(x) >= 2}, data3)
data3 = gsub("\\='","",data3)
data3 = gsub("\\'","",data3)
data3 = gsub("\\.","",data3)
data3 = gsub("\\d+","",data3)
data3 = gsub("[ㄱ-ㅎ]","",data3)
data3 = gsub("(ㅜ|ㅠ)","",data3)
data3 = gsub("[0-9]","",data3)
data3 = gsub("[a-z]","",data3)
data3 = gsub("[A-Z]","",data3)
data3 = gsub(" ","",data3)
data3 = gsub("Q","",data3)
data3 = gsub("","",data3)
data3 = gsub("제목","",data3)
data3 = gsub("아니고","",data3)
data3 = gsub("서울시","",data3)
data3 = gsub("서울","",data3)
data3 = gsub("상담내용","",data3)
data3 = gsub("--상담내용","",data3)
data3 = gsub("\\-","",data3)
write(unlist(data3), "응답소gsub_03.txt")
data4=read.table("응답소gsub_03.txt")
nrow(data4)
wordcount = table(data4)
palete = brewer.pal(10, "Set1")
head(sort(wordcount, decreasing=T),20)
wordcloud(names(wordcount),freq=wordcount,scale=c(1,0.5),rot.per=0.25,min.freq=40,
random.order=F,random.color=T,colors=palete)
data1= readLines("응답소_2015_03.txt")
wordcloud(names(wordcount),freq=wordcount,scale=c(1,0.5),rot.per=0.25,min.freq=20,
random.order=F,random.color=T,colors=palete)
wordcloud(names(wordcount),freq=wordcount,scale=c(1,0.5),rot.per=0.25,min.freq=10,
random.order=F,random.color=T,colors=palete)
#4
data1= readLines("응답소_2015_04.txt")
data4=read.table("응답소gsub_04.txt")
write(unlist(data3), "응답소gsub_04.txt")
data4=read.table("응답소gsub_04.txt")
wordcloud(names(wordcount),freq=wordcount,scale=c(1,0.5),rot.per=0.25,min.freq=10,
random.order=F,random.color=T,colors=palete)
#5
data1= readLines("응답소_2015_005.txt")
#5
data1= readLines("응답소_2015_005.txt")
knitr::opts_chunk$set(echo = TRUE)
setwd("D:/workspace/R_date/Part2/새 폴더")
library(KoNLP)
library(wordcloud)
library(RColorBrewer)
useSejongDic()
knitr::opts_chunk$set(echo = TRUE)
setwd("D:/workspace/R_date/Part2/새 폴더")
library(KoNLP)
library(wordcloud)
library(RColorBrewer)
useSejongDic()
data1= readLines("응답소_2015_01.txt")
data2 = sapply(data1, extractNoun, USE.NAMES = F)
data3 = unlist(data2)
data3= Filter(function(x) {nchar(x) >= 2}, data3)
head(unlist(data3),30)
data3 = gsub("\\='","",data3)
data3 = gsub("\\'","",data3)
data3 = gsub("\\.","",data3)
data3 = gsub("\\d+","",data3)
data3 = gsub("[ㄱ-ㅎ]","",data3)
data3 = gsub("(ㅜ|ㅠ)","",data3)
data3 = gsub("[0-9]","",data3)
data3 = gsub("[a-z]","",data3)
data3 = gsub("[A-Z]","",data3)
data3 = gsub(" ","",data3)
data3 = gsub("Q","",data3)
data3 = gsub("","",data3)
data3 = gsub("제목","",data3)
data3 = gsub("아니고","",data3)
data3 = gsub("서울시","",data3)
data3 = gsub("서울","",data3)
data3 = gsub("상담내용","",data3)
data3 = gsub("--상담내용","",data3)
data3 = gsub("\\-","",data3)
write(unlist(data3), "응답소gsub_01.txt")
data4=read.table("응답소gsub_01.txt")
nrow(data4)
wordcount = table(data4)
palete = brewer.pal(10, "Set1")
head(sort(wordcount, decreasing=T),20)
wordcloud(names(wordcount),freq=wordcount,scale=c(1,0.5),rot.per=0.25,min.freq=35,
random.order=F,random.color=T,colors=palete)
#2
data1= readLines("응답소_2015_02.txt")
data2 = sapply(data1, extractNoun, USE.NAMES = F)
data3 = unlist(data2)
data3= Filter(function(x) {nchar(x) >= 2}, data3)
head(unlist(data3),30)
data3 = gsub("\\='","",data3)
data3 = gsub("\\'","",data3)
data3 = gsub("\\.","",data3)
data3 = gsub("\\d+","",data3)
data3 = gsub("[ㄱ-ㅎ]","",data3)
data3 = gsub("(ㅜ|ㅠ)","",data3)
data3 = gsub("[0-9]","",data3)
data3 = gsub("[a-z]","",data3)
data3 = gsub("[A-Z]","",data3)
data3 = gsub(" ","",data3)
data3 = gsub("Q","",data3)
data3 = gsub("","",data3)
data3 = gsub("제목","",data3)
data3 = gsub("아니고","",data3)
data3 = gsub("서울시","",data3)
data3 = gsub("서울","",data3)
data3 = gsub("상담내용","",data3)
data3 = gsub("--상담내용","",data3)
data3 = gsub("\\-","",data3)
write(unlist(data3), "응답소gsub_02.txt")
data4=read.table("응답소gsub_02.txt")
nrow(data4)
wordcount = table(data4)
palete = brewer.pal(10, "Set1")
head(sort(wordcount, decreasing=T),20)
wordcloud(names(wordcount),freq=wordcount,scale=c(1,0.5),rot.per=0.25,min.freq=10,
random.order=F,random.color=T,colors=palete)
# 3
data1= readLines("응답소_2015_03.txt")
data2 = sapply(data1, extractNoun, USE.NAMES = F)
data3 = unlist(data2)
data3= Filter(function(x) {nchar(x) >= 2}, data3)
data3 = gsub("\\='","",data3)
data3 = gsub("\\'","",data3)
data3 = gsub("\\.","",data3)
data3 = gsub("\\d+","",data3)
data3 = gsub("[ㄱ-ㅎ]","",data3)
data3 = gsub("(ㅜ|ㅠ)","",data3)
data3 = gsub("[0-9]","",data3)
data3 = gsub("[a-z]","",data3)
data3 = gsub("[A-Z]","",data3)
data3 = gsub(" ","",data3)
data3 = gsub("Q","",data3)
data3 = gsub("","",data3)
data3 = gsub("제목","",data3)
data3 = gsub("아니고","",data3)
data3 = gsub("서울시","",data3)
data3 = gsub("서울","",data3)
data3 = gsub("상담내용","",data3)
data3 = gsub("--상담내용","",data3)
data3 = gsub("\\-","",data3)
write(unlist(data3), "응답소gsub_03.txt")
data4=read.table("응답소gsub_03.txt")
nrow(data4)
wordcount = table(data4)
palete = brewer.pal(10, "Set1")
wordcloud(names(wordcount),freq=wordcount,scale=c(1,0.5),rot.per=0.25,min.freq=10,
random.order=F,random.color=T,colors=palete)
#4
data1= readLines("응답소_2015_04.txt")
data2 = sapply(data1, extractNoun, USE.NAMES = F)
data3 = unlist(data2)
data3= Filter(function(x) {nchar(x) >= 2}, data3)
data3 = gsub("\\='","",data3)
data3 = gsub("\\'","",data3)
data3 = gsub("\\.","",data3)
data3 = gsub("\\d+","",data3)
data3 = gsub("[ㄱ-ㅎ]","",data3)
data3 = gsub("(ㅜ|ㅠ)","",data3)
data3 = gsub("[0-9]","",data3)
data3 = gsub("[a-z]","",data3)
data3 = gsub("[A-Z]","",data3)
data3 = gsub(" ","",data3)
data3 = gsub("Q","",data3)
data3 = gsub("","",data3)
data3 = gsub("제목","",data3)
data3 = gsub("아니고","",data3)
data3 = gsub("서울시","",data3)
data3 = gsub("서울","",data3)
data3 = gsub("상담내용","",data3)
data3 = gsub("--상담내용","",data3)
data3 = gsub("\\-","",data3)
write(unlist(data3), "응답소gsub_04.txt")
data4=read.table("응답소gsub_04.txt")
nrow(data4)
wordcount = table(data4)
palete = brewer.pal(10, "Set1")
head(sort(wordcount, decreasing=T),20)
wordcloud(names(wordcount),freq=wordcount,scale=c(1,0.5),rot.per=0.25,min.freq=10,
random.order=F,random.color=T,colors=palete)
